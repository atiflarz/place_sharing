<div class='row'>
  <div class = 'col-md-2 col-sm-2 col-xs-2 col-lg-2'></div>
  <div class = 'col-md-8 col-sm-8 col-xs-8 col-lg-8'>
    <div class= 'text-center'>
      
    <h3><%=location_message(@places)%></h3>
    <p>
      <div id="map"></div>
    </p>
    </div>
  </div>
  <div class = 'col-md-2 col-sm-2 col-xs-2 col-lg-2'></div>
</div>

<script>
  initMap(<%=raw @places.to_json%>, 'map')

  function initMap(places, id){
    if (places.length == 0){
      places = [{latitude: 22.578193, longitude: 88.428619}]
    }
    var map = new google.maps.Map(document.getElementById(id), {
      zoom: 4,
      center: new google.maps.LatLng(places[0].latitude, places[0].longitude),
    });
    var markers;
    for (i = 0; i < places.length; i++) {
      markers = new google.maps.Marker({
        position: new google.maps.LatLng(places[i].latitude, places[i].longitude),
        map: map,
        animation: google.maps.Animation.DROP,
        draggable: true
      });
      google.maps.event.addListener(markers, "dragend", function(){
        var lat = document.getElementById('place_latitude');
        var lng = document.getElementById('place_longitude');
        var coords = this.getPosition()
        lat.value = coords.lat();
        lng.value = coords.lng();
      });
    }
  }
</script>
